# AGRX MVP TODO

- [x] Configure AGRX color palette and design tokens in theme.config.js
- [x] Set up Inter and JetBrains Mono fonts
- [x] Configure 5-tab navigation (Home, Markets, Trade, Portfolio, Social)
- [x] Add icon mappings for all tab icons
- [x] Build Home screen — portfolio value hero with P&L glow
- [x] Build Home screen — mini sparkline chart
- [x] Build Home screen — daily challenge card
- [x] Build Home screen — trending stocks horizontal scroll
- [x] Build Home screen — social feed preview
- [x] Build Home screen — streak counter
- [x] Build Markets screen — search bar with filter chips
- [x] Build Markets screen — market status indicator
- [x] Build Markets screen — asset list with sparklines
- [x] Build Markets screen — categories section
- [x] Build Asset Detail screen — price header and interactive chart
- [x] Build Asset Detail screen — Buy/Sell CTAs
- [x] Build Asset Detail screen — sentiment bar and news
- [x] Build Trade bottom sheet — quick amounts and order flow
- [x] Build Trade bottom sheet — swipe-to-confirm
- [x] Build Trade bottom sheet — success animation and share prompt
- [x] Build Portfolio screen — total value with P&L glow
- [x] Build Portfolio screen — tab selector (All/Stocks/Options/Copied)
- [x] Build Portfolio screen — holdings list
- [x] Build Social screen — community feed
- [x] Build Social screen — leaderboard
- [x] Build Social screen — achievements/badges
- [x] Build Demo mode toggle and persistent banner
- [x] Build Onboarding flow (Welcome → Demo/Live choice)
- [ ] Build P&L Share Card generation
- [ ] Build Simple/Advanced mode toggle
- [x] Generate custom app logo
- [x] Update app.config.ts with AGRX branding
- [x] Create checkpoint and deliver MVP
- [x] Create server-side stock data router with YahooFinance API integration
- [x] Build stock data service with caching and rate-limit handling
- [x] Map ATHEX stock symbols to Yahoo Finance .AT suffixes
- [x] Create tRPC endpoints: getQuote, getChart, getMultipleQuotes
- [x] Build client-side React Query hooks for live stock data
- [x] Update Home screen to use live data with loading/error states
- [x] Update Markets screen to use live data with loading/error states
- [x] Update Asset Detail screen to use live chart data
- [x] Update Portfolio screen to use live prices for holdings
- [x] Add pull-to-refresh for data refresh on key screens
- [x] Write tests for the stock data service (7 integration tests passing)
- [x] Audit full theme pipeline (theme.config.js → theme.ts → tailwind → CSS vars → useColors → components)
- [x] Rebuild theme.config.js with comprehensive light/dark palettes (20 tokens: primary, background, surface, surfaceSecondary, foreground, muted, onPrimary, border, success, warning, error, accent, gold, silver, bronze + 5 alpha variants)
- [x] Fix ThemeProvider: removed console.log, dynamic vars() from all tokens, proper CSS variable injection
- [x] Ensure tailwind.config.js correctly consumes CSS variables
- [x] Verify useColors hook returns correct palette per scheme
- [x] Update all components to use token-based colors consistently (no hardcoded colors)
- [x] Test light and dark mode switching end-to-end
- [x] Remove all hardcoded color values from screens and components (0 violations in grep audit)
- [x] Research Coinbase/Robinhood/Binance dark mode palettes for reference (CDS v8 gray spectrum)
- [x] Audit current dark mode rendering across all screens
- [x] Fine-tune dark background/surface/surfaceSecondary for OLED contrast (#0A0B0D → #1A1C23 → #262830)
- [x] Fine-tune dark foreground/muted for readability (WCAG AA: #EEF0F3 fg, #89909E muted)
- [x] Fine-tune dark border token for subtle separation (#282A30)
- [x] Fine-tune dark primary/accent/success/warning/error (CDS dark spectrum: #578BFA, #27AD74, #ED5966, #EBBA00)
- [x] Fine-tune dark alpha variants for proper translucency (14-16% opacity)
- [x] Update global.css dark mode CSS variables to match new tokens
- [x] Verify all screens render correctly in dark mode
- [x] Run all tests including design system validation (58 passed + 19 WCAG contrast tests)
- [x] BUG FIX: "No stocks found" when live API is unavailable (rate limit exhausted)
- [x] Diagnose root cause: empty array from API is truthy, fallback never triggered
- [x] Implement graceful fallback: check array.length > 0 instead of truthiness
- [x] Ensure UI is never empty — DEMO DATA badge shown when using mock data
- [x] Test fallback behavior end-to-end (verified via screenshot + 58 tests passing)
- [x] Research complete ATHEX General Index constituent list (145 tickers from stockanalysis.com)
- [x] Verify Yahoo Finance symbols for all ATHEX stocks (135 of 144 valid with .AT suffix)
- [x] Update stockService.ts with all 135 verified symbols (18 blue-chip, 15 dividend, 102 growth)
- [x] Update mock-data.ts GREEK_STOCKS to cover all 135 stocks with representative prices
- [x] Test full API integration with complete ATHEX list (58 tests passing, 0 TS errors)
- [x] Install Inter and JetBrains Mono fonts via @expo-google-fonts
- [x] Configure font loading in root layout with splash screen hold
- [x] Define typographic scale: 12 levels (LargeTitle→Caption2 + 4 mono variants)
- [x] Create reusable Typography text components (14 named exports)
- [x] Update all screens + shared components to use Typography components
- [x] Test font rendering and run all tests (58 passed, 0 TS errors)
- [x] Build theme preference context with light/dark/system toggle
- [x] Persist theme preference with AsyncStorage
- [x] Update ThemeProvider to respect manual theme override (ThemePreference type + resolveScheme)
- [x] Build Settings screen with theme toggle section (radio buttons: System/Light/Dark)
- [x] Build Settings screen with notification preferences section (4 toggles with AsyncStorage)
- [x] Build Settings screen with account/about section (demo mode, version, legal links)
- [x] Add Settings route accessible from Home screen gear icon
- [x] Test theme switching end-to-end and run all tests (58 passed, 0 TS errors)
- [x] Research real ATHEX sector classifications for all 135 stocks (15 sectors mapped)
- [x] Add sector field to LiveStockQuote interface and shared lib/sectors.ts module
- [x] Build sector filter chips UI on Markets screen (horizontal scroll with counts + emoji icons)
- [x] Add "All" default filter, sector-based grouping, and sort options (Gainers/Losers/Volume/A→Z)
- [x] Test sector filtering end-to-end (58 tests passed, 0 TS errors)
- [x] Create WatchlistContext with AsyncStorage persistence
- [x] Wire WatchlistProvider into root layout
- [x] Add star/favorite toggle button to AssetRow component (with haptic feedback)
- [x] Add "Watchlist" as a sector filter chip on Markets screen (gold star chip with count)
- [x] Add star toggle to Asset Detail screen header (gold/muted star + haptics)
- [ ] Add watchlist section to Home screen (if user has watchlisted stocks)
- [x] Test watchlist feature end-to-end (58 tests passed, 0 TS errors)
- [x] Research news APIs: Google News RSS (free, no key) + OpenRouter for sentiment
- [x] Build server-side news service with Google News RSS, 15min cache, XML parser
- [x] Create tRPC news router with getStockNews, getMarketNews, and refreshNews endpoints
- [x] Build client-side useStockNews and useMarketNews hooks with 5min staleTime
- [x] Update Asset Detail screen with live news feed, sentiment bar, and article links
- [x] Compute dynamic sentiment via OpenRouter (Gemini 2.0 Flash) + keyword fallback
- [x] Update sentiment bar on Asset Detail to reflect live news sentiment
- [x] Add Market News section to Home screen (4 articles with source + time)
- [x] Test news integration end-to-end (63 tests passed, 5 news-specific tests)
- [x] Build ShareCard component with 9:16 canvas (stock name, P&L, mini chart, sentiment, AGRX branding)
- [x] Build share card generation service (ViewShot capture to image)
- [x] Integrate native share sheet (expo-sharing)
- [x] Add share trigger to Trade success confirmation screen
- [x] Add share trigger to Portfolio holdings (per-stock share button)
- [x] Add share trigger to Asset Detail screen
- [x] Add time frame selector (Today/This Week/This Month/All Time) on share card
- [x] Test share card rendering and share flow end-to-end (84 tests passed, 21 share-card tests)
- [x] BUG FIX: Theme switching causes visual glitches without full reload
- [x] Audit theme pipeline: theme.config.js → theme.ts → ThemeProvider → CSS vars → NativeWind → useColors
- [x] Fix ThemeProvider: key-based re-render, synchronous CSS var injection, proper NativeWind colorScheme.set()
- [x] Fix root layout: reactive StatusBar (light/dark based on resolved scheme)
- [x] Fix tab layout: key-based re-render on theme change for tab bar colors
- [x] Add smooth CSS transitions (200ms) for web theme switching, disabled on SVG
- [x] Verify all 25+ screens and components switch themes dynamically without reload
- [x] Write 19 theme-switching tests covering pipeline integrity, provider, layout, and component reactivity
- [x] Run full test suite: 103 tests passed, 0 TS errors
- [x] Read backend docs (server/README.md) and understand push notification infrastructure
- [x] Build server-side PriceAlertService (periodic price checks, threshold comparison, cooldown logic)
- [x] Build server-side notification delivery via Expo Push Notifications API
- [x] Create tRPC notificationRouter (registerDevice, getAlerts, addAlert, removeAlert, toggleAlert, updatePreferences)
- [x] Build client-side NotificationProvider (permission request, push token registration, listeners)
- [x] Build push token registration (Expo push token → server via tRPC)
- [x] Build AddAlertModal (alert type selector, threshold input, smart placeholders)
- [x] Build Price Alerts management screen (FlatList, toggle, delete, permission banner, empty state)
- [x] Integrate price alert bell button on Asset Detail screen (active/inactive state)
- [x] Add 'Manage Price Alerts' navigation to Settings screen
- [x] Register price-alerts route in root layout
- [x] Add bell.badge.fill icon mapping
- [x] Write 71 push notification tests (service, router, context, UI integration)
- [x] Run full test suite: 174 tests passed, 0 TS errors
- [x] Audit notification context data model and Home screen header for integration points
- [x] Extend NotificationContext with notification history array, persistence (AsyncStorage), and unread count
- [x] Add markAsRead, markAllAsRead, removeFromHistory, clearHistory functions to context
- [x] Build Notification History screen (grouped by Today/Yesterday/This Week/Earlier, alert details, timestamps, read/unread state)
- [x] Add delete button on individual history items (with native confirmation dialog)
- [x] Add "Read All" and "Clear" header actions
- [x] Add bell icon with unread badge count (red dot, capped at 9+) to Home screen header
- [x] Wire bell icon to navigate to Notification History screen
- [x] Add Notification History link to Settings screen
- [x] Register notification-history route in root layout
- [x] Add icon mappings (trash, clock, newspaper, arrow.up, arrow.down, percent, etc.)
- [x] Write 76 notification history tests (data model, persistence, grouping, rendering, actions, badge)
- [x] Run full test suite: 250 tests passed, 0 TS errors
- [x] Research React 19 official docs: new APIs, breaking changes, hooks rules, compiler, concurrent features
- [x] Read skill-creator skill and create React 19 skill (SKILL.md + references + audit script)
- [x] Create comprehensive React 19 skill with new-apis.md, compiler-rules.md, and audit-react19.sh
- [x] Audit AGRX codebase against React 19 skill — identified all violations
- [x] FIX: Hooks ordering crash in _layout.tsx (hooks after early return `if (!fontsLoaded) return null`)
- [x] FIX: Context.Provider → direct Context rendering (theme-provider, demo-context, watchlist-context, notification-context)
- [x] FIX: forwardRef → ref as regular prop (typography.tsx, share-card.tsx)
- [x] FIX: React Compiler purity — moved Date() call from render body into useMemo (markets.tsx)
- [x] Verified: no defaultProps, propTypes, string refs, legacy context, findDOMNode
- [x] Verified: React Compiler enabled (app.config.ts experiments.reactCompiler: true)
- [x] Run full test suite after React 19 fixes: 250 tests passed, 0 TS errors
